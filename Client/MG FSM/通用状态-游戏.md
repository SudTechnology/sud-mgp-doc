
#

![SUD](../../Resource/logo.png)

# 通用状态-游戏

> Tips
>
> 1. SDK保证状态有序串行从MG到达APP；
> 2. 可重复通知，无需保证通知次数；
> 3. 通知后SudMGP保证状态有序串行从MG到达APP；会按state值缓存最新一次的data值，供APP随时主动获取；

## 测试状态

- state

```txt
mg_common_hello_fsm
```

- data

```json
{
    "msg": "Hello FSM from MG!"
}
```

- 说明

```txt
用于状态测试。
```

### 1. 公屏消息（已修改）
- 最低版本: v1.1.30.xx
- state

```
mg_common_public_message
```

- data

```json
旧格式
{
	"type": 0,
	"msg": "玩家<!--name:用户A|uid:0001|color:#00FF00-->击败了玩家<!--name:用户B|uid:0002|color:0xFF0000-->！",
}

新格式
{
        "type":0,
        "msg":[
            {
                "phrase":1,
                "text":{
                    "default":"玩家",
                    "en-US":"Player"
                }
            },
            {
                "phrase":2,
                "user":{
                    "name":"用户A",
                    "uid":"0001",
                    "color":"#00FF00"
                }
            },
            {
                "phrase":1,
                "text":{
                    "default":"击败了玩家",
                    "en-US":"击败了玩家"
                }
            },
            {
                "phrase":2,
                "user":{
                    "name":"用户B",
                    "uid":"0002",
                    "color":"#FF0000"
                }
            }
        ]
    }
```

- 说明

```
向公屏发送消息，字段含义如下
type
0 通知
1 提醒
2 结算
3 其他
msg

<!-- -->内为转义字段：
<!--name:用户昵称|uid:用户UID|color:建议颜色-->
其中name/uid/color均为可选字段，字段为空的情况如下：
<!--name:|uid:|color:-->
SDK仅会缓存最新一条。
```

- json

|字段|类型|必填|默认|注释|
|:----    |:-------    |:--- |-- -|------      |
|type | int |是   |    |   词组类型   |
|msg | json[词组,词组] |是   |    |   词组json数组   |

- 词组

|字段|类型|必填|默认|注释|
|:----    |:-------    |:--- |-- -|------      |
|phrase |int |是   |    |   词组类型   |
|text |json | 当phrase=1时，是  |    |   当phrase=1时，必填    |
|user |json | 当phrase=2时，是  |    |   当phrase=2时，必填    |

-  当phrase=1时参数说明

|字段|类型|必填|默认|注释|
|:----    |:-------    |:--- |-- -|------      |
|text |json |是   |    |   词组类型   |
|text.default |string |是   |    |   default，文本默认   |
|text.zh-CN |string |否   |    |   zh-CN，文本    |
|text.en-US |string |否   |    |   en-US，文本    |
|text.XXXX |string |否   |    |   XXXX，文本    |
|text.XXXX |string |否   |    |   XXXX 规则：languageCode(小写)-CountryCode(大写)    |

-  当phrase=2时参数说明

|字段|类型|必填|默认|注释|
|:----    |:-------    |:--- |-- -|------      |
|user |json | 是   |    |   当phrase=2时，必填    |
|name |string | 是    |    |   当phrase=2时，必填   |
|uid |string | 是    |    |   当phrase=2时，必填   |
|color |string | 是    |    |   当phrase=2时，必填   |

### 2. 关键词状态

- state

```
mg_common_key_word_to_hit
```

- data

```json
{
	"word": "关键" // 关键
}
```

- 说明

```txt
关键词
```

### 3. 游戏结算状态
- 最低版本: v1.1.30.xx
- state

```
mg_common_game_settle
```
- data

|字段|类型|必填|默认|注释|
|:----    |:-------    |:--- |---|------      |
|gameMode |int | 是   |  1  |   游戏模式默认为1    |
|results |PlayerResult json数组 | 是    |    |  游戏结果玩家列表   |

- PlayerResult = {}

|字段|类型|必填|默认|注释|
|:----    |:-------    |:--- |---|------      |
|uid |string | 是    |    |  用户id   |
|rank |int | 是    |    |   排名 从 1 开始  |
|award |int | 是    |    |   奖励   |
|score |int | 是   |    |   积分   |
|isEscaped |int | 否    |    |  是否逃跑 1：逃跑 0：非逃跑  |
|killerId |string | 否    |    |  杀自己的玩家的id  |

- data

```json
{
    "gameMode": 1, 					// 游戏模式
    "results": [
        {
            "uid": "用户id",        // 用户id
            "rank": 1,             	// 排名 从 1 开始
            "award": 100,           // 奖励
            "score": 100,           // 积分
            "isEscaped": 1,         // 逃跑
            "killerId": "杀自己的玩家id"    // 杀自己的玩家id
        }
    ]
}
```

- 说明

```txt
游戏结算状态
```