#

![SUD](../../Resource/logo.png)

## 通用状态-玩家

> Tips
>
> 1. SudMGP保证状态有序串行从MG到达APP；
> 2. 可重复通知，无需保证通知次数；
> 3. 通知后SudMGP保证状态有序串行从MG到达APP；会按UID和state值缓存最新一次的data值，供APP随时主动获取；
> 4. MG会通知房间内每个用户（包括所有玩家和所有OB）的状态，APP可按需处理展现。

### 0. 测试状态

- state

```
mg_common_player_hello_fsm
```

- data

```json
{
	"msg": "Hello FSM from MG player!"
}
```

- 说明

```txt
用于状态测试。
```

### 1.加入状态（已修改）
- 最低版本: v1.1.30.xx
- state

```
mg_common_player_in
```

- data

```json
{
	"retCode": 0,			// 0 成功，非0不成功（详情见错误码）
	"isIn": true, 		  // 当retCode==0时有效； true 已加入，false 未加入;
	"teamId":1,   		// 当retCode==0时有效；加入哪支队伍;
	"reason": 0,		  // 当isIn==false时有效；0 主动退出，1 被踢;（当retCode != 0时，reason默认-1，无意义便于处理）
	"kickUID":""		  // 当reason==1时有效；kickUID为踢人的用户uid；判断被踢的人是本人条件(onPlayerStateChange(userId==kickedUID == selfUID)；（当retCode != 0时，kickUID默认""，无意义便于处理）
}
```

- 说明

```txt
用户是否加入游戏；
游戏开始后，未加入的用户为OB视角。
```

### 2.准备状态（已修改）
- 最低版本: v1.1.30.xx
- state

```
mg_common_player_ready
```

- data

```json
{
	"retCode": 0,			// 0 成功，非0不成功（详情见错误码）
	"isReady": true	  // 当retCode==0时有效；true 已准备，false 未准备
}
```

- 说明

```txt
用户是否准备。
```

### 3.队长状态（已修改）
- 最低版本: v1.1.30.xx
- state

```
mg_common_player_captain
```

- data

```json
{
	"retCode": 0,				// 0 成功，非0不成功（详情见错误码）
	"isCaptain": true   // 当retCode==0时有效；true 是队长，false 不是队长；
}
```

- 说明

```txt
用户是否为队长，队长在游戏中会有开始游戏的权利。
```

### 4.游戏状态（已修改）
- 最低版本: v1.1.30.xx
- state

```
mg_common_player_playing
```

- data

```json
{
	"retCode": 0,		// 0 成功，非0不成功（详情见错误码）
	"isPlaying": true,  // 当retCode==0时有效；true 游戏中，false 未在游戏中；
	"reason": 0,		   // 当isPlaying==false时有效；isPlaying=false, 0:正常结束 1:提前结束（自己不玩了）2:无真人可以提前结束（无真人，只有机器人） 3:所有人都提前结束；
	"spaceMax": true // true 建议尽量收缩原生UI，给游戏留出尽量大的操作空间 false 初始状态；
}
```

- 说明

```txt
用户游戏状态，如果用户在游戏中，建议：
a.空出屏幕中心区：
关闭全屏礼物特效；
b.部分强操作类小游戏（spaceMax为true），尽量收缩原生UI，给游戏留出尽量大的操作空间：
收缩公屏；
收缩麦位；
如果不在游戏中，则恢复。
```